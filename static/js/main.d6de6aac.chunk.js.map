{"version":3,"sources":["WithLinks.js","Show.js","Viewer.js","App.js","index.js"],"names":["tumblr_re","GfycatStore","store","JSON","parse","localStorage","getItem","e","cleanExpired","now","Date","id","expiresAt","get","_get","Object","asyncToGenerator","regenerator_default","a","mark","_callee","gfyId","resp","json","wrap","_context","prev","next","fetch","concat","sent","url","gfyItem","webmUrl","getTime","setItem","stringify","abrupt","stop","this","_x","apply","arguments","Gfycat","props","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","pathname","substr","then","setState","catch","err","console","error","video","keepFullScreen","setTimeout","requestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullScreen","webkitEnterFullScreen","bind","_this2","react_default","createElement","ref","v","autoPlay","loop","controls","src","Component","Iframe","_this3","imgLoaded","loading","_this$props","title","restProps","objectWithoutProperties","assign","className","onLoad","frameBorder","scrolling","Img","_this4","imgErrored","alt","href","onError","style","objectFit","Strategy","_ref","host","slice","protocol","replace","test","Show_Img","Show_Gfycat","origin","match","searchParams","split","_url$pathname$match$s","_url$pathname$match$s2","slicedToArray","username","pic_id","src_base","toLowerCase","join","backgroundImage","map","ext","Show_Iframe","Show","_ref2","source","link","URL","key","flexGrow","flexShrink","padding","paddingTop","color","target","rel","Show_Strategy","LinkConsumer","Viewer","handleFullScreenChange","document","fullscreenElement","matches","isFullScreen","handleKeys","ctrlKey","altKey","shiftKey","metaKey","querySelector","code","paused","play","pause","pos","list","links","Math","min","length","_ref3","max","keys","window","addEventListener","capture","passive","removeEventListener","_this$state","disabled","onClick","value","onChange","l","Show_Show","LinkedViewer","_Component","_class2","_getPrototypeOf2","_len","args","Array","_key","handleFile","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","files","Symbol","iterator","done","file","complete","res","reduce","b","x","_b$x","push","toConsumableArray","data","startsWith","return","inherits","createClass","backgroundColor","width","height","display","justifyContent","alignItems","type","accept","multiple","htmlFor","inp","arr","i","j","floor","random","shuffled","App","ReactDOM","render","App_App","getElementById"],"mappings":"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","file":"static/js/main.d6de6aac.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport { parse } from \"papaparse\";\nimport \"./WithLinks.css\";\n\nfunction shuffled(inp) {\n  const arr = inp.slice();\n  for (let i = arr.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [arr[i], arr[j]] = [arr[j], arr[i]];\n  }\n  return arr;\n}\n\nexport default LinkConsumer =>\n  class extends Component {\n    state = {};\n\n    handleFile = e => {\n      for (let file of e.target.files) {\n        parse(file, {\n          complete: res =>\n            this.setState(state =>\n              Object.keys(state).reduce(\n                (b, x) => {\n                  if (!(x in b)) b[x] = [];\n                  b[x].push(...state[x]);\n                  return b;\n                },\n                res.data.reduce((a, [list, src]) => {\n                  if (src && src.startsWith(\"http\")) {\n                    if (!(list in a)) a[list] = [];\n                    a[list].push(src);\n                  }\n                  return a;\n                }, {})\n              )\n            )\n        });\n      }\n    };\n\n    render() {\n      if (Object.keys(this.state).length === 0) {\n        return (\n          <div\n            style={{\n              backgroundColor: \"black\",\n              width: \"100%\",\n              height: \"100%\",\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignItems: \"center\"\n            }}\n          >\n            <div className=\"file-input-container\">\n              <h1>BFV</h1>\n              <input\n                id=\"file-input\"\n                type=\"file\"\n                accept=\".csv\"\n                onChange={this.handleFile}\n                multiple\n              />\n              <label htmlFor=\"file-input\">Choose a file</label>\n            </div>\n          </div>\n        );\n      }\n      return (\n        <LinkConsumer\n          links={Object.keys(this.state).reduce((a, x) => {\n            a[x] = shuffled(this.state[x]);\n            return a;\n          }, {})}\n        />\n      );\n    }\n  };\n","import React, { Component } from \"react\";\nimport \"./Show.css\";\n\nconst tumblr_re = /^\\d+?\\.media\\.tumblr\\.com$/;\n\nconst gfycatStoreKey = \"gfycatUrls\";\nconst GfycatStore = (() => {\n  let store;\n  try {\n    store = JSON.parse(localStorage.getItem(gfycatStoreKey) || \"{}\");\n  } catch (e) {\n    store = {};\n  }\n\n  const cleanExpired = () => {\n    const now = new Date();\n    for (const id in store) {\n      if (store[id].expiresAt <= now) delete store[id];\n    }\n  };\n\n  return {\n    get: async gfyId => {\n      cleanExpired();\n      if (!(gfyId in store)) {\n        const resp = await fetch(`https://api.gfycat.com/v1/gfycats/${gfyId}`);\n        const json = await resp.json();\n        store[gfyId] = {\n          url: json.gfyItem.webmUrl,\n          expiresAt: new Date().getTime() + 1 * 24 * 60 * 60 * 1000, // 1 day\n        };\n      }\n      localStorage.setItem(gfycatStoreKey, JSON.stringify(store));\n      return store[gfyId].url;\n    },\n  };\n})();\n\nclass Gfycat extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { webmUrl: null };\n    GfycatStore.get(props.url.pathname.substr(1))\n      .then(webmUrl => this.setState({ webmUrl }))\n      .catch(err => console.error(err));\n  }\n\n  componentDidMount() {\n    if (this.video && this.props.keepFullScreen) {\n      const { video } = this;\n      setTimeout(\n        () =>\n          (\n            video.requestFullscreen ||\n            video.webkitRequestFullScreen ||\n            video.mozRequestFullScreen ||\n            video.msRequestFullScreen ||\n            video.webkitEnterFullScreen ||\n            (() => null)\n          ).bind(video)(),\n        100,\n      );\n    }\n  }\n\n  render() {\n    return (\n      <video\n        ref={v => (this.video = v)}\n        autoPlay\n        loop\n        controls\n        src={this.state.webmUrl}\n      />\n    );\n  }\n}\n\nclass Iframe extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { loading: true };\n  }\n\n  imgLoaded = () => this.setState({ loading: false });\n\n  render() {\n    const { src, title, ...restProps } = this.props;\n    return (\n      <iframe\n        className={this.state.loading ? \"iframe-loading\" : \"\"}\n        onLoad={this.imgLoaded}\n        title={title}\n        src={src}\n        frameBorder=\"0\"\n        scrolling=\"no\"\n        {...restProps}\n      />\n    );\n  }\n}\n\nclass Img extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { loading: true, error: false };\n  }\n\n  imgLoaded = () => this.setState({ loading: false });\n\n  imgErrored = () => this.setState({ loading: false, error: true });\n\n  render() {\n    const className = this.state.loading\n      ? \"loading\"\n      : this.state.error\n      ? \"error\"\n      : \"\";\n    return (\n      <img\n        className={className}\n        alt=\"\"\n        src={this.props.url.href}\n        onLoad={this.imgLoaded}\n        onError={this.imgErrored}\n        style={{ objectFit: \"contain\" }}\n      />\n    );\n  }\n}\n\nconst Strategy = ({ url, keepFullScreen }) => {\n  let title, src;\n  switch (true) {\n    case url.host === \"i.imgur.com\":\n      if (url.pathname.slice(0, 3) === \"/a/\") {\n        title = \"imgur\";\n        src =\n          url.protocol +\n          \"//imgur.com\" +\n          url.pathname.replace(\".jpg\", \"\") +\n          \"/embed?pub=true\";\n        break;\n      }\n    // eslint-disable-next-line -- FALLTHROUGH\n    case tumblr_re.test(url.host):\n      return <Img url={url} />;\n    case url.host === \"gfycat.com\":\n      return <Gfycat url={url} keepFullScreen={keepFullScreen} />;\n    case url.host === \"www.xvideos.com\":\n      title = \"xvideos\";\n      src =\n        url.origin + \"/embedframe/\" + url.pathname.match(/\\/video(\\d+)\\//)[1];\n      break;\n    case url.host === \"www.pornhub.com\":\n      title = \"pornhub\";\n      src = url.origin + \"/embed/\" + url.searchParams.get(\"viewkey\");\n      break;\n    case url.host === \"xhamster.com\":\n      title = \"xhamster\";\n      src = url.origin + \"/embed/\" + url.pathname.split(\"/\")[2];\n      break;\n    case url.host === \"www.hentai-foundry.com\":\n      const [username, pic_id] = url.pathname\n        .match(/^\\/pictures\\/user\\/(.*)\\/(.*)\\//)\n        .slice(1);\n      const src_base = [\n        \"https://pictures.hentai-foundry.com\",\n        username[0].toLowerCase(),\n        username,\n        pic_id,\n      ].join(\"/\");\n      return (\n        <div\n          className=\"img\"\n          style={{\n            backgroundImage: [\"png\", \"jpg\"]\n              .map(ext => `url(${src_base}.${ext})`)\n              .join(\",\"),\n          }}\n        />\n      );\n    default:\n      title = \"default\";\n      src = url.href;\n  }\n  return <Iframe src={src} title={title} />;\n};\n\nexport default function Show({ link: source, style, keepFullScreen }) {\n  const url = new URL(source);\n  return (\n    <div key={source} className=\"item-container\" style={style}>\n      <div\n        style={{\n          flexGrow: 0,\n          flexShrink: 0,\n          padding: 5,\n          paddingTop: 0,\n          color: \"white\",\n        }}\n      >\n        <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\n          Source\n        </a>\n      </div>\n      <Strategy url={url} keepFullScreen={keepFullScreen} />\n    </div>\n  );\n}\n","import React, { Component } from \"react\";\nimport Show from \"./Show\";\nimport \"./Viewer.css\";\n\nexport default class Viewer extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      pos: 0,\n      list: Object.keys(props.links)[0],\n      isFullScreen: false,\n    };\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"keydown\", this.handleKeys);\n    const video = document.querySelector(\".item-container > video\");\n    if (video) {\n      video.addEventListener(\"fullscreenchange\", this.handleFullScreenChange, {\n        capture: false,\n        passive: true,\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"keydown\", this.handleKeys);\n  }\n\n  componentDidUpdate() {\n    const video = document.querySelector(\".item-container > video\");\n    if (video) {\n      video.addEventListener(\"fullscreenchange\", this.handleFullScreenChange, {\n        capture: false,\n        passive: true,\n      });\n    }\n  }\n\n  handleFullScreenChange = e => {\n    if (\n      document.fullscreenElement &&\n      document.fullscreenElement.matches(\".item-container > video\")\n    ) {\n      this.setState({ isFullScreen: true });\n    } else {\n      this.setState({ isFullScreen: false });\n    }\n  };\n\n  handleKeys = e => {\n    if (e.ctrlKey || e.altKey || e.shiftKey || e.metaKey) {\n      return;\n    }\n    const video = document.querySelector(\".item-container > video\");\n\n    switch (e.code) {\n      case \"ArrowLeft\":\n      case \"KeyA\":\n        return this.prev();\n      case \"ArrowRight\":\n      case \"KeyD\":\n        return this.next();\n      case \"KeyF\":\n        if (video) {\n          (\n            video.requestFullscreen ||\n            video.webkitRequestFullScreen ||\n            video.mozRequestFullScreen ||\n            video.msRequestFullScreen ||\n            video.webkitEnterFullScreen ||\n            (() => null)\n          ).bind(video)();\n        }\n        return;\n      case \"Space\":\n        if (video) {\n          if (video.paused) {\n            video.play();\n          } else {\n            video.pause();\n          }\n        }\n        return;\n      default:\n        return;\n    }\n  };\n\n  next = () => {\n    this.setState(({ pos, list }, { links }) => ({\n      pos: Math.min(pos + 1, links[list].length - 1),\n    }));\n  };\n\n  prev = () => {\n    this.setState(({ pos }) => ({\n      pos: Math.max(pos - 1, 0),\n    }));\n  };\n\n  render() {\n    const { pos, list, isFullScreen } = this.state;\n    const { links } = this.props;\n    return (\n      <div className=\"viewer-container\">\n        <div className=\"button-container\">\n          <button disabled={pos === 0} onClick={this.prev}>\n            Previous\n          </button>\n          <select\n            value={list}\n            onChange={e => this.setState({ list: e.target.value })}\n          >\n            {Object.keys(links).map(l => (\n              <option value={l}>{l}</option>\n            ))}\n          </select>\n          <button disabled={pos === links[list].length - 1} onClick={this.next}>\n            Next\n          </button>\n        </div>\n        <Show link={links[list][pos]} keepFullScreen={isFullScreen} />\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport WithLinks from \"./WithLinks\";\nimport Viewer from \"./Viewer\";\n\nconst LinkedViewer = WithLinks(Viewer);\n\nexport default class App extends Component {\n  render() {\n    return <LinkedViewer />;\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}